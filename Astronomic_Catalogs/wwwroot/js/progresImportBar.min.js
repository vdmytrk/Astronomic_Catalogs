(()=>{"use strict";(()=>{let t;document.addEventListener("DOMContentLoaded",o);let e=null,n=!1;function o(){const o=document.getElementById("importPlanetDataButton"),r=document.getElementById("stopImportingPlanetDataButton");var a;!function(){t=crypto.randomUUID();const e=(new signalR.HubConnectionBuilder).withUrl(`/progresshub?jobId=${t}`).build();e.start().catch((t=>console.error(t.toString()))),e.on("ReceiveProgress",(t=>{const e=document.getElementById("importProgress");e.style.width=t+"%",e.innerText=t+"%",t>=100&&l()}))}(),(a=o)&&a.addEventListener("click",(()=>{if(n)return;n=!0,e=new AbortController;const o=document.getElementById("importPlanetDataButton"),r=document.getElementById("progressContainer"),a=document.getElementById("stopImportingPlanetDataButton");o.disabled=!0,r.style.display="block",a.disabled=!1,a.style.display="inline-block",fetch(`/Planetology/PlanetsCatalog/ImportData_OpenXml?jobId=${t}`,{method:"POST",signal:e.signal}).then((t=>{(t.ok||499===t.status)&&l()})).catch((t=>{"AbortError"===t.name?console.log("Import aborted by user"):console.error("Import error:",t),l()}))})),function(n){n&&n.addEventListener("click",(()=>{e&&e.abort(),fetch(`/Planetology/PlanetsCatalog/CancelImport?jobId=${t}`,{method:"POST"}),l()}))}(r)}function l(){const t=document.getElementById("stopImportingPlanetDataButton"),o=document.getElementById("importPlanetDataButton"),l=document.getElementById("progressContainer"),r=document.getElementById("importProgress");o.disabled=!1,l.style.display="none",r.style.width="0%",r.innerText="0%",t.disabled=!0,t.style.display="none",n=!1,e=null,fetch("/Planetology/PlanetsCatalog/GetPlanetsTable").then((t=>t.text())).then((t=>{document.getElementById("planetsTableContainer").innerHTML=t})).catch((t=>console.error("Error updating table:",t)))}})()})();